<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ambition`s blog</title>
  
  <subtitle>要么写一些值得读的东西，要么做一些值得写的东西</subtitle>
  <link href="/blog/atom.xml" rel="self"/>
  
  <link href="https://amb-zb.gitee.io/blog/"/>
  <updated>2020-01-06T05:23:08.000Z</updated>
  <id>https://amb-zb.gitee.io/blog/</id>
  
  <author>
    <name>ambition</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>mfc实现复制粘贴</title>
    <link href="https://amb-zb.gitee.io/blog/2020/01/06/mfc%E5%AE%9E%E7%8E%B0%E5%A4%8D%E5%88%B6%E7%B2%98%E8%B4%B4/"/>
    <id>https://amb-zb.gitee.io/blog/2020/01/06/mfc%E5%AE%9E%E7%8E%B0%E5%A4%8D%E5%88%B6%E7%B2%98%E8%B4%B4/</id>
    <published>2020-01-06T05:23:08.000Z</published>
    <updated>2020-01-06T05:23:08.000Z</updated>
    
    <content type="html"><![CDATA[<p>进行复制与粘贴，其实就是剪切板的使用，下面介绍具体的使用方法：</p><h1 id="1-复制"><a href="#1-复制" class="headerlink" title="1. 复制"></a>1. 复制</h1><ol><li><p>想要使用剪切板，必须进行注册，为剪切板起一个自己喜欢的名字（当然任何名字都可以，只要自己看着舒服即可，我这里使用的是 “Object_ClipBoard”）：</p><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">UINT</span> g_cfObjectFormat = ::RegisterClipboardFormat(_T(<span class="string">"Object_ClipBoard"</span>));</span><br></pre></td></tr></table></figure><a id="more"></a></li><li><p>想要复制，当然必须要有需要复制的数据，这里进行数据生成，我这里使用的是CSharedFile和CArchive的串行化产生数据的，当然也可以使用别的方式产生数据：</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CSharedFilememFile;</span><br><span class="line">CArchive ar<span class="comment">(&amp;memFile, CArchive::store|CArchive::bNoFlushOnDelete)</span>;</span><br><span class="line"><span class="comment">//在这里用ar进行串行化数据。。。</span></span><br><span class="line">ar&lt;&lt;<span class="number">5</span>;</span><br><span class="line">ar&lt;&lt;<span class="number">6</span>；</span><br><span class="line"><span class="comment">// 结束</span></span><br><span class="line">ar.Flush<span class="comment">()</span>;</span><br><span class="line">HGLOBAL hData = memFile.Detach<span class="comment">()</span>;</span><br></pre></td></tr></table></figure></li><li><p>将生成的数据保存到剪切板中：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//打开剪切板</span></span><br><span class="line"><span class="keyword">if</span>(<span class="constructor">OpenClipboard()</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//设置数据</span></span><br><span class="line">::<span class="constructor">SetClipboardData(<span class="params">g_cfObjectFormat</span>, <span class="params">hData</span>)</span>;</span><br><span class="line"><span class="comment">//关闭剪切板</span></span><br><span class="line"><span class="constructor">CloseClipboard()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h1 id="2-粘贴"><a href="#2-粘贴" class="headerlink" title="2.粘贴"></a>2.粘贴</h1><p>粘贴：当然就是把刚才的剪切板打开，在把数据拿出来，理论是不是很简单，不说了，直接上代码</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//打开剪切板</span></span><br><span class="line"><span class="keyword">if</span>(<span class="constructor">OpenClipboard()</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//拿到剪切板数据</span></span><br><span class="line">    HANDLE hData = ::<span class="constructor">GetClipboardData(<span class="params">g_cfObjectFormat</span>)</span>;</span><br><span class="line">    <span class="keyword">if</span>(hData != NULL)</span><br><span class="line">    &#123;</span><br><span class="line">CSharedFile memFile;</span><br><span class="line">memFile.<span class="constructor">SetHandle(<span class="params">hData</span>,FALSE)</span>;</span><br><span class="line">CArchive ar(&amp;memFile, CArchive::load);</span><br><span class="line"> </span><br><span class="line">        在这里将数据串行化出来。。。</span><br><span class="line"> </span><br><span class="line">        ar.<span class="constructor">Close()</span>;</span><br><span class="line">memFile.<span class="constructor">Detach()</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//清空剪切板</span></span><br><span class="line">        <span class="constructor">EmptyClipboard()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//关闭剪切板</span></span><br><span class="line">    <span class="constructor">CloseClipboard()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>到这里mfc的复制粘贴功能就完成了，是不是一点都不难…</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;进行复制与粘贴，其实就是剪切板的使用，下面介绍具体的使用方法：&lt;/p&gt;
&lt;h1 id=&quot;1-复制&quot;&gt;&lt;a href=&quot;#1-复制&quot; class=&quot;headerlink&quot; title=&quot;1. 复制&quot;&gt;&lt;/a&gt;1. 复制&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;想要使用剪切板，必须进行注册，为剪切板起一个自己喜欢的名字（当然任何名字都可以，只要自己看着舒服即可，我这里使用的是 “Object_ClipBoard”）：&lt;/p&gt;
&lt;figure class=&quot;highlight zephir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;UINT&lt;/span&gt; g_cfObjectFormat = ::RegisterClipboardFormat(_T(&lt;span class=&quot;string&quot;&gt;&quot;Object_ClipBoard&quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="mfc" scheme="https://amb-zb.gitee.io/blog/categories/mfc/"/>
    
    
      <category term="复制" scheme="https://amb-zb.gitee.io/blog/tags/%E5%A4%8D%E5%88%B6/"/>
    
      <category term="粘贴" scheme="https://amb-zb.gitee.io/blog/tags/%E7%B2%98%E8%B4%B4/"/>
    
  </entry>
  
  <entry>
    <title>mfc获取Ctrl、Shift状态</title>
    <link href="https://amb-zb.gitee.io/blog/2020/01/06/mfc%E8%8E%B7%E5%8F%96Ctrl%E3%80%81Shift%E7%8A%B6%E6%80%81/"/>
    <id>https://amb-zb.gitee.io/blog/2020/01/06/mfc%E8%8E%B7%E5%8F%96Ctrl%E3%80%81Shift%E7%8A%B6%E6%80%81/</id>
    <published>2020-01-06T02:23:09.000Z</published>
    <updated>2020-01-06T02:23:09.000Z</updated>
    
    <content type="html"><![CDATA[<p>这个功能非常简单，只要就是用到一个函数GetKeyState，并且知道ctrl、shift的按键代码即可<br>ctrl按键的代码为：VK_CONTROL<br>shift按键的代码为：VK_SHIFT</p><a id="more"></a><p>则获取按键状态的代码为：</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BOOL bCtrl = GetKeyState(<span class="name">VK_CONTROL</span>) &amp; <span class="number">0</span>x8000<span class="comment">;</span></span><br><span class="line">BOOL bShift = (<span class="name">GetKeyState</span>(<span class="name">VK_SHIFT</span>) &amp; <span class="number">0</span>x8000)<span class="comment">;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这个功能非常简单，只要就是用到一个函数GetKeyState，并且知道ctrl、shift的按键代码即可&lt;br&gt;ctrl按键的代码为：VK_CONTROL&lt;br&gt;shift按键的代码为：VK_SHIFT&lt;/p&gt;
    
    </summary>
    
    
      <category term="mfc" scheme="https://amb-zb.gitee.io/blog/categories/mfc/"/>
    
    
      <category term="shift" scheme="https://amb-zb.gitee.io/blog/tags/shift/"/>
    
      <category term="ctrl" scheme="https://amb-zb.gitee.io/blog/tags/ctrl/"/>
    
  </entry>
  
  <entry>
    <title>mfc获取鼠标所在窗口</title>
    <link href="https://amb-zb.gitee.io/blog/2020/01/06/mfc%E8%8E%B7%E5%8F%96%E9%BC%A0%E6%A0%87%E6%89%80%E5%9C%A8%E7%AA%97%E5%8F%A3/"/>
    <id>https://amb-zb.gitee.io/blog/2020/01/06/mfc%E8%8E%B7%E5%8F%96%E9%BC%A0%E6%A0%87%E6%89%80%E5%9C%A8%E7%AA%97%E5%8F%A3/</id>
    <published>2020-01-06T01:53:39.000Z</published>
    <updated>2020-01-06T01:53:39.000Z</updated>
    
    <content type="html"><![CDATA[<p>首先需要获取到鼠标点，再根据鼠标点获取到鼠标所在的窗口即可</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CPoint ptMouse;</span><br><span class="line"><span class="comment">//获取鼠标点</span></span><br><span class="line"><span class="constructor">GetCursorPos(&amp;<span class="params">ptMouse</span>)</span>;</span><br><span class="line"><span class="comment">//根据鼠标点获取所在窗口</span></span><br><span class="line">CWnd<span class="operator"> * </span>pWnd = <span class="constructor">WindowFromPoint(<span class="params">ptMouse</span>)</span>;</span><br></pre></td></tr></table></figure><a id="more"></a>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;首先需要获取到鼠标点，再根据鼠标点获取到鼠标所在的窗口即可&lt;/p&gt;
&lt;figure class=&quot;highlight reasonml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;CPoint ptMouse;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//获取鼠标点&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;constructor&quot;&gt;GetCursorPos(&amp;amp;&lt;span class=&quot;params&quot;&gt;ptMouse&lt;/span&gt;)&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//根据鼠标点获取所在窗口&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;CWnd&lt;span class=&quot;operator&quot;&gt; * &lt;/span&gt;pWnd = &lt;span class=&quot;constructor&quot;&gt;WindowFromPoint(&lt;span class=&quot;params&quot;&gt;ptMouse&lt;/span&gt;)&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="mfc" scheme="https://amb-zb.gitee.io/blog/categories/mfc/"/>
    
    
      <category term="鼠标" scheme="https://amb-zb.gitee.io/blog/tags/%E9%BC%A0%E6%A0%87/"/>
    
  </entry>
  
</feed>
